(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1660:function(e,r,s){Promise.resolve().then(s.bind(s,3268))},3268:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return o}});var t=s(2872),n=s(4209),u=s(5358),a=s(2063);function o(){let{user:e,loading:r}=(0,a.useAuth)(),s=(0,u.useRouter)();return((0,n.useEffect)(()=>{r||(e?s.push("/dashboard"):s.push("/login"))},[e,r,s]),r)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600"})}):null}},2063:function(e,r,s){"use strict";s.r(r),s.d(r,{AuthProvider:function(){return c},useAuth:function(){return i}});var t=s(2872),n=s(4209),u=s(9835),a=s(1397);let o=(0,n.createContext)(void 0);function i(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function c(e){let{children:r}=e,[s,i]=(0,n.useState)(null),[c,l]=(0,n.useState)(null),[d,f]=(0,n.useState)(!0);(0,n.useEffect)(()=>{u.O.auth.getSession().then(e=>{var r;let{data:{session:s}}=e;l(s),i(null!==(r=null==s?void 0:s.user)&&void 0!==r?r:null),f(!1)});let{data:{subscription:e}}=u.O.auth.onAuthStateChange((e,r)=>{var s;l(r),i(null!==(s=null==r?void 0:r.user)&&void 0!==s?s:null),f(!1)});return()=>e.unsubscribe()},[]);let m=async e=>{try{var r,s,t;f(!0);let{data:n,error:o}=await u.O.auth.signInWithPassword({email:e.email,password:e.password});if(o)return a.default.error(o.message),{success:!1,error:o.message,timestamp:new Date};return n.user&&await u.O.from("users").update({last_login:new Date().toISOString()}).eq("id",n.user.id),a.default.success("Successfully signed in!"),{success:!0,user:n.user,accessToken:null===(r=n.session)||void 0===r?void 0:r.access_token,refreshToken:null===(s=n.session)||void 0===s?void 0:s.refresh_token,expiresIn:null===(t=n.session)||void 0===t?void 0:t.expires_in,timestamp:new Date}}catch(r){let e=r instanceof Error?r.message:"An error occurred";return a.default.error(e),{success:!1,error:e,timestamp:new Date}}finally{f(!1)}},h=async e=>{try{f(!0);let{data:r,error:s}=await u.O.auth.signUp({email:e.email,password:e.password,options:{data:{first_name:e.firstName,last_name:e.lastName}}});if(s)return a.default.error(s.message),{success:!1,error:s.message,timestamp:new Date};if(r.user){let{error:s}=await u.O.from("user_profiles").insert({user_id:r.user.id,first_name:e.firstName,last_name:e.lastName,timezone:"UTC",notification_preferences:{email:!0,sms:!1,discord:!1},risk_tolerance:"medium"});s&&console.error("Error creating user profile:",s)}return a.default.success("Account created! Please check your email for verification."),{success:!0,user:r.user,timestamp:new Date}}catch(r){let e=r instanceof Error?r.message:"An error occurred";return a.default.error(e),{success:!1,error:e,timestamp:new Date}}finally{f(!1)}},p=async()=>{try{f(!0);let{error:e}=await u.O.auth.signOut();if(e)throw a.default.error(e.message),e;a.default.success("Successfully signed out!")}catch(e){console.error("Error signing out:",e)}finally{f(!1)}},_=async e=>{try{let{error:r}=await u.O.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(r)return{success:!1,error:r.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An error occurred"}}},v=async e=>{try{if(!s)return{success:!1,error:"No user logged in"};let{error:r}=await u.O.from("user_profiles").update(e).eq("user_id",s.id);if(r)return{success:!1,error:r.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An error occurred"}}};return(0,t.jsx)(o.Provider,{value:{user:s,session:c,loading:d,signIn:m,signUp:h,signOut:p,resetPassword:_,updateProfile:v},children:r})}},9835:function(e,r,s){"use strict";s.d(r,{O:function(){return o}});var t=s(4899),n=s(7337);let u=n.env.NEXT_PUBLIC_SUPABASE_URL||"https://placeholder.supabase.co",a=n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"placeholder-key";("https://placeholder.supabase.co"===u||"placeholder-key"===a)&&console.warn("Missing Supabase environment variables. Please configure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY");let o=(0,t.eI)(u,a)},5358:function(e,r,s){"use strict";var t=s(230);s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}})}},function(e){e.O(0,[676,577,726,744],function(){return e(e.s=1660)}),_N_E=e.O()}]);