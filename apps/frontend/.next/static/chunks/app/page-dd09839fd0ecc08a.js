(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5484:function(e,t,r){Promise.resolve().then(r.bind(r,777))},777:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var s=r(2872),n=r(4209),a=r(5358),i=r(5543);function u(){let{isAuthenticated:e,isLoading:t}=(0,i.useAuth)(),r=(0,a.useRouter)();return(0,n.useEffect)(()=>{t||(e?r.replace("/dashboard"):r.replace("/login"))},[e,t,r]),(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Loading..."})]})})}},5543:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return i},useAuth:function(){return u}});var s=r(2872),n=r(4209);let a=(0,n.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,n.useState)(null),[u,c]=(0,n.useState)(!1),[l,o]=(0,n.useState)(!0),d=async()=>{try{let e=await fetch("/api/auth/me",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();t.success&&t.user?(i(t.user),c(!0)):(i(null),c(!1))}else i(null),c(!1)}catch(e){console.error("Auth check failed:",e),i(null),c(!1)}finally{o(!1)}},h=async(e,t)=>{try{if(o(!0),!e||!t)return{success:!1,message:"Email and password are required"};if(!e.includes("@")||e.length<5)return{success:!1,message:"Please enter a valid email address"};if(t.length<8)return{success:!1,message:"Password must be at least 8 characters"};let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e.toLowerCase().trim(),password:t})}),s=await r.json();if(r.ok&&s.success)return i(s.user),c(!0),{success:!0};return i(null),c(!1),{success:!1,message:s.message||"Login failed. Please check your credentials."}}catch(e){return console.error("Login error:",e),i(null),c(!1),{success:!1,message:"Network error. Please check your connection and try again."}}finally{o(!1)}},f=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})}catch(e){console.error("Logout error:",e)}finally{i(null),c(!1)}};return(0,n.useEffect)(()=>{d();let e=()=>{"visible"===document.visibilityState&&u&&d()};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]),(0,n.useEffect)(()=>{if(!u)return;let e=setInterval(()=>{d()},3e5);return()=>clearInterval(e)},[u]),(0,s.jsx)(a.Provider,{value:{user:r,isAuthenticated:u,isLoading:l,login:h,logout:f,checkAuth:d},children:t})},u=()=>{let e=(0,n.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5358:function(e,t,r){"use strict";var s=r(230);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[577,726,744],function(){return e(e.s=5484)}),_N_E=e.O()}]);