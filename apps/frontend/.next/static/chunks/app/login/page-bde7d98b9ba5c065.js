(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{5261:function(e,r,t){Promise.resolve().then(t.bind(t,3488))},3488:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return o}});var s=t(2872),a=t(4209),n=t(5358),i=t(6045),l=t(5543);function o(){let[e,r]=(0,a.useState)(""),[t,o]=(0,a.useState)(""),[u,c]=(0,a.useState)(""),[d,m]=(0,a.useState)(!1),h=(0,n.useRouter)(),{login:f,isAuthenticated:g}=(0,l.useAuth)(),b=()=>e.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?t.trim()?!(t.length<8)||(c("Password must be at least 8 characters long"),!1):(c("Password is required"),!1):(c("Please enter a valid email address"),!1):(c("Email is required"),!1),y=async r=>{if(r.preventDefault(),c(""),b()){m(!0);try{let r=await f(e.trim(),t);r.success?h.push("/dashboard"):c(r.message||"Login failed. Please try again.")}catch(e){console.error("Login error:",e),c("Network error. Please check your connection and try again.")}finally{m(!1)}}};return g?(h.replace("/dashboard"),null):(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-gray-800/50 p-8 rounded-lg shadow-lg w-full max-w-md",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center mb-6",children:"Control Panel Login"}),(0,s.jsxs)("form",{onSubmit:y,children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),(0,s.jsx)("input",{type:"email",id:"email",value:e,onChange:e=>r(e.target.value),className:"w-full p-3 bg-gray-700 rounded-md border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:d,autoComplete:"email","aria-describedby":u?"error-message":void 0})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),(0,s.jsx)("input",{type:"password",id:"password",value:t,onChange:e=>o(e.target.value),className:"w-full p-3 bg-gray-700 rounded-md border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:d,autoComplete:"current-password","aria-describedby":u?"error-message":void 0})]}),u&&(0,s.jsx)("div",{id:"error-message",className:"mb-4 p-3 bg-red-900/50 border border-red-500 rounded-md",children:(0,s.jsx)("p",{className:"text-red-200 text-sm",role:"alert",children:u})}),(0,s.jsx)(i.z,{type:"submit",className:"w-full",disabled:d,children:d?"Signing In...":"Sign In"})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Secure login with end-to-end encryption"})})]})})}},5543:function(e,r,t){"use strict";t.r(r),t.d(r,{AuthProvider:function(){return i},useAuth:function(){return l}});var s=t(2872),a=t(4209);let n=(0,a.createContext)(void 0),i=e=>{let{children:r}=e,[t,i]=(0,a.useState)(null),[l,o]=(0,a.useState)(!1),[u,c]=(0,a.useState)(!0),d=async()=>{try{let e=await fetch("/api/auth/me",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){let r=await e.json();r.success&&r.user?(i(r.user),o(!0)):(i(null),o(!1))}else i(null),o(!1)}catch(e){console.error("Auth check failed:",e),i(null),o(!1)}finally{c(!1)}},m=async(e,r)=>{try{if(c(!0),!e||!r)return{success:!1,message:"Email and password are required"};if(!e.includes("@")||e.length<5)return{success:!1,message:"Please enter a valid email address"};if(r.length<8)return{success:!1,message:"Password must be at least 8 characters"};let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e.toLowerCase().trim(),password:r})}),s=await t.json();if(t.ok&&s.success)return i(s.user),o(!0),{success:!0};return i(null),o(!1),{success:!1,message:s.message||"Login failed. Please check your credentials."}}catch(e){return console.error("Login error:",e),i(null),o(!1),{success:!1,message:"Network error. Please check your connection and try again."}}finally{c(!1)}},h=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})}catch(e){console.error("Logout error:",e)}finally{i(null),o(!1)}};return(0,a.useEffect)(()=>{d();let e=()=>{"visible"===document.visibilityState&&l&&d()};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]),(0,a.useEffect)(()=>{if(!l)return;let e=setInterval(()=>{d()},3e5);return()=>clearInterval(e)},[l]),(0,s.jsx)(n.Provider,{value:{user:t,isAuthenticated:l,isLoading:u,login:m,logout:h,checkAuth:d},children:r})},l=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5358:function(e,r,t){"use strict";var s=t(230);t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})},6045:function(e,r,t){"use strict";t.d(r,{z:function(){return a}});var s=t(2872);function a(e){let{children:r,className:t="",...a}=e;return(0,s.jsx)("button",{className:"px-5 py-2.5 text-base cursor-pointer bg-blue-600 text-white border-0 rounded-md hover:bg-blue-700 transition-colors ".concat(t),...a,children:r})}t(4209)}},function(e){e.O(0,[577,726,744],function(){return e(e.s=5261)}),_N_E=e.O()}]);