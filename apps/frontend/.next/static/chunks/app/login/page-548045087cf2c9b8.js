(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{8233:function(e,s,r){Promise.resolve().then(r.bind(r,853))},853:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return p}});var t=r(2872),a=r(4209),n=r(5358),o=r(1911),i=r(4700),c=r(5820),l=r(8237),u=r(2063),d=r(6073),m=r(144);let f=l.z.object({email:l.z.string().email("Invalid email address"),password:l.z.string().min(8,"Password must be at least 8 characters"),twoFactorCode:l.z.string().optional()});function p(){let[e,s]=(0,a.useState)(!1),[r,l]=(0,a.useState)(!1),{signIn:p}=(0,u.useAuth)(),h=(0,n.useRouter)(),{register:g,handleSubmit:x,formState:{errors:w},setError:y}=(0,i.cI)({resolver:(0,c.F)(f)}),v=async e=>{l(!0);try{let s=await p(e);s.success?h.push("/dashboard"):y("root",{message:s.error||"Login failed"})}catch(e){y("root",{message:"An unexpected error occurred"})}finally{l(!1)}};return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),(0,t.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",(0,t.jsx)(o.default,{href:"/register",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"create a new account"})]})]}),(0,t.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:x(v),children:[(0,t.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),(0,t.jsx)("input",{...g("email"),type:"email",autoComplete:"email",className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address"}),w.email&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.email.message})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,t.jsx)("input",{...g("password"),type:e?"text":"password",autoComplete:"current-password",className:"appearance-none rounded-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password"}),(0,t.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!e),children:e?(0,t.jsx)(d.Z,{className:"h-5 w-5 text-gray-400"}):(0,t.jsx)(m.Z,{className:"h-5 w-5 text-gray-400"})}),w.password&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.password.message})]})]}),w.root&&(0,t.jsx)("div",{className:"text-red-600 text-sm text-center",children:w.root.message}),(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)(o.default,{href:"/forgot-password",className:"text-sm text-indigo-600 hover:text-indigo-500",children:"Forgot your password?"})}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Signing in...":"Sign in"})})]})]})})}},2063:function(e,s,r){"use strict";r.r(s),r.d(s,{AuthProvider:function(){return l},useAuth:function(){return c}});var t=r(2872),a=r(4209),n=r(9835),o=r(1397);let i=(0,a.createContext)(void 0);function c(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function l(e){let{children:s}=e,[r,c]=(0,a.useState)(null),[l,u]=(0,a.useState)(null),[d,m]=(0,a.useState)(!0);(0,a.useEffect)(()=>{n.O.auth.getSession().then(e=>{var s;let{data:{session:r}}=e;u(r),c(null!==(s=null==r?void 0:r.user)&&void 0!==s?s:null),m(!1)});let{data:{subscription:e}}=n.O.auth.onAuthStateChange((e,s)=>{var r;u(s),c(null!==(r=null==s?void 0:s.user)&&void 0!==r?r:null),m(!1)});return()=>e.unsubscribe()},[]);let f=async e=>{try{var s,r,t;m(!0);let{data:a,error:i}=await n.O.auth.signInWithPassword({email:e.email,password:e.password});if(i)return o.default.error(i.message),{success:!1,error:i.message,timestamp:new Date};return a.user&&await n.O.from("users").update({last_login:new Date().toISOString()}).eq("id",a.user.id),o.default.success("Successfully signed in!"),{success:!0,user:a.user,accessToken:null===(s=a.session)||void 0===s?void 0:s.access_token,refreshToken:null===(r=a.session)||void 0===r?void 0:r.refresh_token,expiresIn:null===(t=a.session)||void 0===t?void 0:t.expires_in,timestamp:new Date}}catch(s){let e=s instanceof Error?s.message:"An error occurred";return o.default.error(e),{success:!1,error:e,timestamp:new Date}}finally{m(!1)}},p=async e=>{try{m(!0);let{data:s,error:r}=await n.O.auth.signUp({email:e.email,password:e.password,options:{data:{first_name:e.firstName,last_name:e.lastName}}});if(r)return o.default.error(r.message),{success:!1,error:r.message,timestamp:new Date};if(s.user){let{error:r}=await n.O.from("user_profiles").insert({user_id:s.user.id,first_name:e.firstName,last_name:e.lastName,timezone:"UTC",notification_preferences:{email:!0,sms:!1,discord:!1},risk_tolerance:"medium"});r&&console.error("Error creating user profile:",r)}return o.default.success("Account created! Please check your email for verification."),{success:!0,user:s.user,timestamp:new Date}}catch(s){let e=s instanceof Error?s.message:"An error occurred";return o.default.error(e),{success:!1,error:e,timestamp:new Date}}finally{m(!1)}},h=async()=>{try{m(!0);let{error:e}=await n.O.auth.signOut();if(e)throw o.default.error(e.message),e;o.default.success("Successfully signed out!")}catch(e){console.error("Error signing out:",e)}finally{m(!1)}},g=async e=>{try{let{error:s}=await n.O.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(s)return{success:!1,error:s.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An error occurred"}}},x=async e=>{try{if(!r)return{success:!1,error:"No user logged in"};let{error:s}=await n.O.from("user_profiles").update(e).eq("user_id",r.id);if(s)return{success:!1,error:s.message};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An error occurred"}}};return(0,t.jsx)(i.Provider,{value:{user:r,session:l,loading:d,signIn:f,signUp:p,signOut:h,resetPassword:g,updateProfile:x},children:s})}},9835:function(e,s,r){"use strict";r.d(s,{O:function(){return i}});var t=r(4899),a=r(7337);let n=a.env.NEXT_PUBLIC_SUPABASE_URL||"https://placeholder.supabase.co",o=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"placeholder-key";("https://placeholder.supabase.co"===n||"placeholder-key"===o)&&console.warn("Missing Supabase environment variables. Please configure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY");let i=(0,t.eI)(n,o)}},function(e){e.O(0,[676,376,911,577,726,744],function(){return e(e.s=8233)}),_N_E=e.O()}]);